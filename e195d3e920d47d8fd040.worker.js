!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=11)}([function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(6),e),i(r(13),e),i(r(8),e),i(r(14),e)},function(t,e,r){"use strict";var n,i=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.writeColor=void 0;const o=r(2),a=r(0);let s=n=class{constructor(t,e,r){this.x=0,this.y=0,this.z=0,this.x=null!=t?t:0,this.y=null!=e?e:0,this.z=null!=r?r:0}get array(){return[this.x,this.y,this.z]}set(t,e,r){this.x=t,this.y=e,this.z=r}copyTo(t){t.x=this.x,t.y=this.y,t.z=this.z}get r(){return this.x}set r(t){this.x=t}get g(){return this.y}set g(t){this.y=t}get b(){return this.z}set b(t){this.z=t}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}negate(){return new n(-this.x,-this.y,-this.z)}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}divideScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}toString(){return`${this.x}, ${this.y}, ${this.z}`}static addVec3(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z)}static subVec3(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z)}static multVec3(t,e){return new n(t.x*e.x,t.y*e.y,t.z*e.z)}static multScalarVec3(t,e){return new n(e*t.x,e*t.y,e*t.z)}static divScalarVec(t,e){return new n(t.x/e,t.y/e,t.z/e)}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){return new n(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static unit_vector(t){return n.divScalarVec(t,t.length())}static random(){return new n(o.randomNumber(),o.randomNumber(),o.randomNumber())}static randomRange(t,e){return new n(o.randomNumberRange(t,e),o.randomNumberRange(t,e),o.randomNumberRange(t,e))}static randomInUnitSphere(){for(;;){const t=n.randomRange(-1,1);if(!(t.lengthSquared()>=1))return t}}static randomUnitVector(){const t=o.randomNumberRange(0,2*Math.PI),e=o.randomNumberRange(-1,1),r=Math.sqrt(1-e*e);return new n(r*Math.cos(t),r*Math.sin(t),e)}static randomInHemisphere(t){const e=n.randomInUnitSphere();return n.dot(e,t)>0?e:e.negate()}static reflect(t,e){return n.subVec3(t,n.multScalarVec3(e,2*n.dot(t,e)))}static refract(t,e,r){const i=n.dot(t.negate(),e),o=n.addVec3(t,n.multScalarVec3(e,i)),a=n.multScalarVec3(o,r),s=n.multScalarVec3(e,-Math.sqrt(1-a.lengthSquared()));return n.addVec3(a,s)}static randomInUnitdisk(){for(;;){const t=new n(o.randomNumberRange(-1,1),o.randomNumberRange(-1,1),0);if(!(t.lengthSquared()>=1))return t}}};s=n=i([a.serializable],s),e.default=s,e.writeColor=function(t,e,r,n){let i=r.r,o=r.g,a=r.b;const s=1/n;i=Math.sqrt(s*i),o=Math.sqrt(s*o),a=Math.sqrt(s*a),t[e++]=255*i,t[e++]=255*o,t[e++]=255*a,t[e++]=255}},function(t,e,r){"use strict";function n(){return Math.random()}function i(t,e){return t+(e-t)*n()}Object.defineProperty(e,"__esModule",{value:!0}),e.sortArrayRange=e.randomInt=e.clamp=e.randomNumberRange=e.randomNumber=e.degreeToRadians=void 0,e.degreeToRadians=function(t){return t*Math.PI/180},e.randomNumber=n,e.randomNumberRange=i,e.clamp=function(t,e,r){return t<e?e:t>r?r:t},e.randomInt=function(t,e){return Math.floor(i(t,e+1))},e.sortArrayRange=function(t,e,r,n){t=[].concat(...t.slice(0,e),...t.slice(e,e+r).sort(n),...t.slice(e+r,t.length))}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.rayColor=void 0;const i=n(r(1)),o=r(4);class a{constructor(t,e,r=0){t&&(this._orig=t),e&&(this._dir=e),this._time=r}copyTo(t){t._orig=this._orig,t._dir=this._dir,t._time=this._time}get origin(){return this._orig}set origin(t){this._orig=t}get direction(){return this._dir}set direction(t){this._dir=t}get time(){return this._time}at(t){return i.default.addVec3(this._orig,i.default.multScalarVec3(this._dir,t))}}e.default=a,e.rayColor=function t(e,r,n){const s=new o.HitRecord;if(n<=0)return new i.default(0,0,0);if(r.hit(e,.001,Number.POSITIVE_INFINITY,s)){const o=new a,u=new i.default;return s.mat.scatter(e,s,u,o)?i.default.multVec3(u,t(o,r,n-1)):new i.default(0,0,0)}const u=.5*(i.default.unit_vector(e.direction).y+1),c=i.default.multScalarVec3(new i.default(1,1,1),1-u),l=i.default.multScalarVec3(new i.default(.5,.7,1),u);return i.default.addVec3(c,l)}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Hittable=e.HitRecord=void 0;const i=n(r(1));e.HitRecord=class{constructor(){this.p=new i.default,this.normal=new i.default,this.t=0,this.u=0,this.v=0,this.front_face=!0}set_face_normal(t,e){this.front_face=i.default.dot(t.direction,e)<0,this.normal=this.front_face?e:e.negate()}copyTo(t){t.p=this.p,t.normal=this.normal,t.t=this.t,t.u=this.u,t.v=this.v,t.front_face=this.front_face,t.mat=this.mat}};e.Hittable=class{}},function(t,e,r){"use strict";var n,i=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=o(r(1)),s=r(0);let u=n=class{constructor(t,e){this._min=null!=t?t:new a.default,this._max=null!=e?e:new a.default}copyTo(t){t._min=this._min,t._max=this._max}get min(){return this._min}get max(){return this._max}hit(t,e,r){for(let n=0;n<3;n++){const i=1/t.direction.array[n];let o=(this._min.array[n]-t.origin.array[n])*i,a=(this._max.array[n]-t.origin.array[n])*i;if(i<0){const t=o;o=a,a=t}if((r=a<r?a:r)<=(e=o>e?o:e))return!1}return!0}static surroundingBox(t,e){const r=new a.default(Math.min(t.min.x,e.min.x),Math.min(t.min.y,e.min.y),Math.min(t.min.z,e.min.z)),i=new a.default(Math.max(t.max.x,e.max.x),Math.max(t.max.y,e.max.y),Math.max(t.max.z,e.max.z));return new n(r,i)}};u=n=i([s.serializable],u),e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CLASSNAME_KEY=void 0,e.CLASSNAME_KEY="__CLASSNAME__"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=void 0;const n=r(6),i=r(9);e.deserialize=function(t,e){return function t(e,r){const o=Object.create(e.prototype);for(const e in r){const a=r[e];if(Array.isArray(a))o[e]=a.map(e=>t(i.getClassConstructor(e[n.CLASSNAME_KEY]),e));else if("object"==typeof a){const r=i.getClassConstructor(a[n.CLASSNAME_KEY]);o[e]=t(r,a)}else o[e]=a}return o}(t,e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClassConstructor=e.addClassName=void 0;const n=new Map;e.addClassName=function(t){n.set(t.name,t)},e.getClassConstructor=function(t){return n.has(t)?n.get(t):(console.error(t+" not serializable, use the @serializable decorator"),null)}},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.CheckerTexture=e.SolidColor=e.Texture=void 0;const i=r(0);class o{}e.Texture=o;let a=class extends o{constructor(t){super(),this._color=t}value(t,e,r){return this._color}};a=n([i.serializable],a),e.SolidColor=a;let s=class extends o{constructor(t,e){super(),this._odd=new a(t),this._even=new a(e)}value(t,e,r){return Math.sin(10*r.x)*Math.sin(10*r.y)*Math.sin(10*r.z)<0?this._odd.value(t,e,r):this._even.value(t,e,r)}};s=n([i.serializable],s),e.CheckerTexture=s},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=n(r(12)),o=r(8),a=r(2),s=n(r(1)),u=n(r(5)),c=n(r(15)),l=n(r(16)),d=r(17),f=n(r(18)),h=n(r(19)),m=n(r(20)),_=r(3),p=n(r(21)),b=r(10),y=r(22),g=self;let v;f.default,h.default,l.default,p.default,m.default,c.default,u.default,b.CheckerTexture,b.SolidColor;const x=(t,e,r,n)=>{let i=r.r,o=r.g,a=r.b;const s=1/n;i=Math.sqrt(s*i),o=Math.sqrt(s*o),a=Math.sqrt(s*a),t[e++]=255*i,t[e++]=255*o,t[e++]=255*a};g.addEventListener("message",t=>{const e=t.data;switch(e.cmd){case y.ComputeCommands.START:(t=>{v=t.data.workerId;const e=o.deserialize(i.default,t.data.camera),r=o.deserialize(d.HittableList,t.data.world),n=t.data.imageWidth,u=t.data.imageHeight,c=t.data.scanlineCount,l=t.data.startLine,f=t.data.samplesPerPixel,h=t.data.maxBounces;console.log(`worker[${v}] startLine: ${l}`),console.log(`worker[${v}] linecount: ${c}`);const m=new Uint8ClampedArray(n*c*3);let p=0;const b=l+1-c;let M=c;for(let t=l;t>=b;t--){console.log(`worker[${v}] scanlines remaining ${M--}`);for(let i=0;i<n;i++){let o=new s.default(0,0,0);for(let c=0;c<f;c++){const c=(i+a.randomNumber())/(n-1),l=(t+a.randomNumber())/(u-1),d=e.getRay(c,l);o=s.default.addVec3(o,_.rayColor(d,r,h))}x(m,p,o,f),p+=3}}const j={cmd:y.ComputeCommands.END,data:{workerId:v,pixelArray:m,startLine:l,scanlineCount:c}};g.postMessage(j)})(e)}})},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(r(1)),a=i(r(3)),s=r(2),u=r(0);let c=class{constructor(){}init(t,e,r,n,i,a,u,c=0,l=0){const d=s.degreeToRadians(n),f=2*Math.tan(d/2),h=i*f;this.w=o.default.unit_vector(o.default.subVec3(t,e)),this.u=o.default.unit_vector(o.default.cross(r,this.w)),this.v=o.default.cross(this.w,this.u),this.lookFrom=t,this.horizontal=o.default.multScalarVec3(this.u,u*h),this.vertical=o.default.multScalarVec3(this.v,u*f);const m=o.default.divScalarVec(this.horizontal,2),_=o.default.divScalarVec(this.vertical,2),p=o.default.multScalarVec3(this.w,u);this.lowerLeftCorner=o.default.subVec3(o.default.subVec3(o.default.subVec3(this.lookFrom,m),_),p),this.lenseRadius=a/2,this.time0=c,this.time1=l}getRay(t,e){const r=o.default.multScalarVec3(o.default.randomInUnitdisk(),this.lenseRadius),n=o.default.multScalarVec3(this.u,r.x),i=o.default.multScalarVec3(this.v,r.y),u=o.default.addVec3(n,i),c=o.default.multScalarVec3(this.horizontal,t),l=o.default.multScalarVec3(this.vertical,e);return new a.default(o.default.addVec3(this.lookFrom,u),o.default.subVec3(o.default.subVec3(o.default.addVec3(o.default.addVec3(this.lowerLeftCorner,c),l),this.lookFrom),u),s.randomNumberRange(this.time0,this.time1))}getUniformArray(){const t=[];return t.push(...this.lookFrom.array,0),t.push(...this.lowerLeftCorner.array,0),t.push(...this.horizontal.array,0),t.push(...this.vertical.array,0),t.push(...this.u.array,0),t.push(...this.v.array,0),t.push(...this.w.array,0),t.push(this.lenseRadius),new Float32Array(t)}};c=n([u.serializable],c),e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;const n=r(6);e.serialize=function(t,e){return function t(e,r){const i={},o=Object.getOwnPropertyNames(r);for(const e of o){const n=r[e];Array.isArray(n)?i[e]=n.map(e=>t(e.constructor,e)):i[e]="object"==typeof n?t(n.constructor,n):n}return i[n.CLASSNAME_KEY]=r.constructor.name,i}(0,e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serializable=void 0;const n=r(9);e.serializable=function(t){n.addClassName(t)}},function(t,e,r){"use strict";var n,i=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=r(4),s=o(r(5)),u=r(2),c=r(0);let l=n=class extends a.Hittable{constructor(){super(),this.box=new s.default}static createFromHitableList(t){const e=new n;return e.init(t.objects,0,t.objects.length),e}static createFromObjects(t,e,r){const i=new n;return i.init(t,e,r),i}init(t,e,r){const i=u.randomInt(0,2),o=0===i?f:1===i?h:m,a=r-e;if(1===a)this.left=this.right=t[e];else if(2===a)-1===o(t[e],t[e+1])?(this.left=t[e],this.right=t[e+1]):(this.left=t[e+1],this.right=t[e]);else{u.sortArrayRange(t,e,r,o);const i=e+Math.floor(a/2);this.left=n.createFromObjects(t,e,i),this.right=n.createFromObjects(t,i,r)}const c=new s.default,l=new s.default;this.left.boundingBox(c)&&this.right.boundingBox(l)||console.error("No bounding box in bvh_node constructor."),this.box=s.default.surroundingBox(c,l)}hit(t,e,r,n){return!!this.box.hit(t,e,r)&&(this.left.hit(t,e,r,n)?(this.right.hit(t,e,n.t,n),!0):this.right.hit(t,e,r,n))}boundingBox(t){return this.box.copyTo(t),!0}};function d(t,e,r){const n=new s.default,i=new s.default;return t.boundingBox(n)&&e.boundingBox(i)||console.error("No bounding box in bvh_node constructor."),n.min.array[r]<i.min.array[r]?-1:1}function f(t,e){return d(t,e,0)}function h(t,e){return d(t,e,1)}function m(t,e){return d(t,e,2)}l=n=i([c.serializable],l),e.default=l},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(r(7)),a=i(r(3)),s=r(2),u=i(r(1)),c=r(0);let l=class extends o.default{constructor(t){super(),this._refIdx=t}schlick(t,e){let r=(1-e)/(1+e);return r*=r,r+(1-r)*Math.pow(1-t,5)}scatter(t,e,r,n){r.set(1,1,1);const i=e.front_face?1/this._refIdx:this._refIdx,o=u.default.unit_vector(t.direction),c=Math.min(u.default.dot(o.negate(),e.normal),1);if(i*Math.sqrt(1-c*c)>1){const r=u.default.reflect(o,e.normal);return new a.default(e.p,r,t.time).copyTo(n),!0}const l=this.schlick(c,i);if(s.randomNumber()<l){const r=u.default.reflect(o,e.normal);return new a.default(e.p,r,t.time).copyTo(n),!0}const d=u.default.refract(o,e.normal,i);return new a.default(e.p,d,t.time).copyTo(n),!0}};l=n([c.serializable],l),e.default=l},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HittableList=void 0;const o=r(4),a=i(r(5)),s=r(0);let u=class extends o.Hittable{constructor(t){super(),this._objects=[],t&&this.add(t)}get objects(){return this._objects}clear(){this._objects.length=0}add(t){this._objects.push(t)}hit(t,e,r,n){const i=new o.HitRecord;let a=!1,s=r;for(const r of this._objects)r.hit(t,e,s,i)&&(a=!0,s=i.t,i.copyTo(n));return a}boundingBox(t){if(0===this._objects.length)return!1;const e=new a.default;let r=!0;for(const n of this._objects){if(!n.boundingBox(e))return!1;r?e.copyTo(t):a.default.surroundingBox(t,e).copyTo(t),r=!1}return!0}};u=n([s.serializable],u),e.HittableList=u},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(r(7)),a=i(r(3)),s=i(r(1)),u=r(0),c=r(10);let l=class extends o.default{constructor(t){super(),t&&(this.albedo=new c.SolidColor(t))}set texture(t){this.albedo=t}scatter(t,e,r,n){const i=s.default.addVec3(e.normal,s.default.randomUnitVector());new a.default(e.p,i,t.time).copyTo(n);return this.albedo.value(e.u,e.v,e.p).copyTo(r),!0}};l=n([u.serializable],l),e.default=l},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(r(7)),a=i(r(3)),s=i(r(1)),u=r(0);let c=class extends o.default{constructor(t,e){super(),this.albedo=t,this.roughness=e}scatter(t,e,r,n){const i=s.default.reflect(s.default.unit_vector(t.direction),e.normal);return new a.default(e.p,s.default.addVec3(i,s.default.multScalarVec3(s.default.randomInUnitSphere(),this.roughness)),t.time).copyTo(n),this.albedo.copyTo(r),s.default.dot(n.direction,e.normal)>0}};c=n([u.serializable],c),e.default=c},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(0),a=i(r(1)),s=r(4);let u=class extends s.Hittable{constructor(t,e,r,n,i,o){super(),this.center0=t,this.center1=e,this.time0=r,this.time1=n,this.radius=i,this.mat=o}hit(t,e,r,n){const i=a.default.subVec3(t.origin,this.center(t.time)),o=t.direction.lengthSquared(),s=a.default.dot(i,t.direction),u=s*s-o*(i.lengthSquared()-this.radius*this.radius);if(u>0){const i=Math.sqrt(u);let c=(-s-i)/o;if(c<r&&c>e){n.t=c,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center(t.time)),this.radius);return n.set_face_normal(t,e),n.mat=this.mat,!0}if(c=(-s+i)/o,c<r&&c>e){n.t=c,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center(t.time)),this.radius);return n.set_face_normal(t,e),n.mat=this.mat,!0}}return!1}center(t){const e=(t-this.time0)/(this.time1-this.time0),r=a.default.subVec3(this.center1,this.center0);return a.default.addVec3(this.center0,a.default.multScalarVec3(r,e))}boundingBox(t){return!0}};u=n([o.serializable],u),e.default=u},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=r(4),a=i(r(1)),s=i(r(5)),u=r(0);function c(t){const e=Math.atan2(t.z,t.x),r=Math.asin(t.y);return{u:1-(e+Math.PI)/(2*Math.PI),v:(r+Math.PI/2)/Math.PI}}let l=class extends o.Hittable{constructor(t,e,r){super(),this.center=t,this.radius=e,this.mat=r}hit(t,e,r,n){const i=a.default.subVec3(t.origin,this.center),o=t.direction.lengthSquared(),s=a.default.dot(i,t.direction),u=s*s-o*(i.lengthSquared()-this.radius*this.radius);if(u>0){const i=Math.sqrt(u);let l=(-s-i)/o;if(l<r&&l>e){n.t=l,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius);n.set_face_normal(t,e);const r=c(a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius));return n.u=r.u,n.v=r.v,n.mat=this.mat,!0}if(l=(-s+i)/o,l<r&&l>e){n.t=l,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius);n.set_face_normal(t,e);const r=c(a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius));return n.u=r.u,n.v=r.v,n.mat=this.mat,!0}}return!1}boundingBox(t){return new s.default(a.default.subVec3(this.center,new a.default(this.radius,this.radius,this.radius)),a.default.addVec3(this.center,new a.default(this.radius,this.radius,this.radius))).copyTo(t),!0}};l=n([u.serializable],l),e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ComputeCommands=e.ControllerCommands=void 0,function(t){t[t.START=0]="START",t[t.STOP=1]="STOP",t[t.END=2]="END"}(e.ControllerCommands||(e.ControllerCommands={})),function(t){t[t.START=0]="START",t[t.END=1]="END"}(e.ComputeCommands||(e.ComputeCommands={}))}]);