!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=10)}([function(t,e,r){"use strict";var n,o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};Object.defineProperty(e,"__esModule",{value:!0}),e.writeColor=void 0;const i=r(2),a=r(1);let s=n=class{constructor(t,e,r){this.x=0,this.y=0,this.z=0,this.x=null!=t?t:0,this.y=null!=e?e:0,this.z=null!=r?r:0}get array(){return[this.x,this.y,this.z]}set(t,e,r){this.x=t,this.y=e,this.z=r}copyTo(t){t.x=this.x,t.y=this.y,t.z=this.z}get r(){return this.x}set r(t){this.x=t}get g(){return this.y}set g(t){this.y=t}get b(){return this.z}set b(t){this.z=t}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}negate(){return new n(-this.x,-this.y,-this.z)}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}divideScalar(t){return this.x/=t,this.y/=t,this.z/=t,this}toString(){return`${this.x}, ${this.y}, ${this.z}`}static addVec3(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z)}static subVec3(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z)}static multVec3(t,e){return new n(t.x*e.x,t.y*e.y,t.z*e.z)}static multScalarVec3(t,e){return new n(e*t.x,e*t.y,e*t.z)}static divScalarVec(t,e){return new n(t.x/e,t.y/e,t.z/e)}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){return new n(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static unit_vector(t){return n.divScalarVec(t,t.length())}static random(){return new n(i.randomNumber(),i.randomNumber(),i.randomNumber())}static randomRange(t,e){return new n(i.randomNumberRange(t,e),i.randomNumberRange(t,e),i.randomNumberRange(t,e))}static randomInUnitSphere(){for(;;){const t=n.randomRange(-1,1);if(!(t.lengthSquared()>=1))return t}}static randomUnitVector(){const t=i.randomNumberRange(0,2*Math.PI),e=i.randomNumberRange(-1,1),r=Math.sqrt(1-e*e);return new n(r*Math.cos(t),r*Math.sin(t),e)}static randomInHemisphere(t){const e=n.randomInUnitSphere();return n.dot(e,t)>0?e:e.negate()}static reflect(t,e){return n.subVec3(t,n.multScalarVec3(e,2*n.dot(t,e)))}static refract(t,e,r){const o=n.dot(t.negate(),e),i=n.addVec3(t,n.multScalarVec3(e,o)),a=n.multScalarVec3(i,r),s=n.multScalarVec3(e,-Math.sqrt(1-a.lengthSquared()));return n.addVec3(a,s)}static randomInUnitdisk(){for(;;){const t=new n(i.randomNumberRange(-1,1),i.randomNumberRange(-1,1),0);if(!(t.lengthSquared()>=1))return t}}};s=n=o([a.serializable],s),e.default=s,e.writeColor=function(t,e,r,n){let o=r.r,i=r.g,a=r.b;const s=1/n;o=Math.sqrt(s*o),i=Math.sqrt(s*i),a=Math.sqrt(s*a),t[e++]=255*o,t[e++]=255*i,t[e++]=255*a,t[e++]=255}},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(6),e),o(r(12),e),o(r(8),e),o(r(13),e)},function(t,e,r){"use strict";function n(){return Math.random()}function o(t,e){return t+(e-t)*n()}Object.defineProperty(e,"__esModule",{value:!0}),e.sortArrayRange=e.randomInt=e.clamp=e.randomNumberRange=e.randomNumber=e.degreeToRadians=void 0,e.degreeToRadians=function(t){return t*Math.PI/180},e.randomNumber=n,e.randomNumberRange=o,e.clamp=function(t,e,r){return t<e?e:t>r?r:t},e.randomInt=function(t,e){return Math.floor(o(t,e+1))},e.sortArrayRange=function(t,e,r,n){t=[].concat(...t.slice(0,e),...t.slice(e,e+r).sort(n),...t.slice(e+r,t.length))}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.rayColor=void 0;const o=n(r(0)),i=r(4);class a{constructor(t,e){t&&(this._orig=t),e&&(this._dir=e)}copyTo(t){t._orig=this._orig,t._dir=this._dir}get origin(){return this._orig}set origin(t){this._orig=t}get direction(){return this._dir}set direction(t){this._dir=t}at(t){return o.default.addVec3(this._orig,o.default.multScalarVec3(this._dir,t))}}e.default=a,e.rayColor=function t(e,r,n){const s=new i.HitRecord;if(n<=0)return new o.default(0,0,0);if(r.hit(e,.001,Number.POSITIVE_INFINITY,s)){const i=new a,c=new o.default;return s.mat.scatter(e,s,c,i)?o.default.multVec3(c,t(i,r,n-1)):new o.default(0,0,0)}const c=.5*(o.default.unit_vector(e.direction).y+1),u=o.default.multScalarVec3(new o.default(1,1,1),1-c),l=o.default.multScalarVec3(new o.default(.5,.7,1),c);return o.default.addVec3(u,l)}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Hittable=e.HitRecord=void 0;const o=n(r(0));e.HitRecord=class{constructor(){this.p=new o.default,this.normal=new o.default,this.t=0,this.front_face=!0}set_face_normal(t,e){this.front_face=o.default.dot(t.direction,e)<0,this.normal=this.front_face?e:e.negate()}copyTo(t){t.p=this.p,t.normal=this.normal,t.t=this.t,t.front_face=this.front_face,t.mat=this.mat}};e.Hittable=class{}},function(t,e,r){"use strict";var n,o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(r(0)),s=r(1);let c=n=class{constructor(t,e){this._min=null!=t?t:new a.default,this._max=null!=e?e:new a.default}copyTo(t){t._min=this._min,t._max=this._max}get min(){return this._min}get max(){return this._max}hit(t,e,r){for(let n=0;n<3;n++){const o=1/t.direction.array[n];let i=(this._min.array[n]-t.origin.array[n])*o,a=(this._max.array[n]-t.origin.array[n])*o;if(o<0){const t=i;i=a,a=t}if((r=a<r?a:r)<=(e=i>e?i:e))return!1}return!0}static surroundingBox(t,e){const r=new a.default(Math.min(t.min.x,e.min.x),Math.min(t.min.y,e.min.y),Math.min(t.min.z,e.min.z)),o=new a.default(Math.max(t.max.x,e.max.x),Math.max(t.max.y,e.max.y),Math.max(t.max.z,e.max.z));return new n(r,o)}};c=n=o([s.serializable],c),e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CLASSNAME_KEY=void 0,e.CLASSNAME_KEY="__CLASSNAME__"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deserialize=void 0;const n=r(6),o=r(9);e.deserialize=function(t,e){return function t(e,r){const i=Object.create(e.prototype);for(const e in r){const a=r[e];if(Array.isArray(a))i[e]=a.map(e=>t(o.getClassConstructor(e[n.CLASSNAME_KEY]),e));else if("object"==typeof a){const r=o.getClassConstructor(a[n.CLASSNAME_KEY]);i[e]=t(r,a)}else i[e]=a}return i}(t,e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClassConstructor=e.addClassName=void 0;const n=new Map;e.addClassName=function(t){n.set(t.name,t)},e.getClassConstructor=function(t){return n.has(t)?n.get(t):(console.error(t+" not serializable, use the @serializable decorator"),null)}},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=n(r(11)),i=r(14),a=r(3),s=r(2),c=n(r(0)),u=r(15),l=r(8),d=n(r(16)),f=n(r(17)),h=n(r(18)),m=n(r(19)),_=n(r(20)),p=n(r(5)),b=self;let y;f.default,h.default,m.default,d.default,_.default,p.default;const g=(t,e,r,n)=>{let o=r.r,i=r.g,a=r.b;const s=1/n;o=Math.sqrt(s*o),i=Math.sqrt(s*i),a=Math.sqrt(s*a),t[e++]=255*o,t[e++]=255*i,t[e++]=255*a};b.addEventListener("message",t=>{const e=t.data;switch(e.cmd){case u.ComputeCommands.START:(t=>{y=t.data.workerId;const e=l.deserialize(o.default,t.data.camera),r=l.deserialize(i.HittableList,t.data.world),n=t.data.imageWidth,d=t.data.imageHeight,f=t.data.scanlineCount,h=t.data.startLine,m=t.data.samplesPerPixel,_=t.data.maxBounces;console.log(`worker[${y}] startLine: ${h}`),console.log(`worker[${y}] linecount: ${f}`);const p=new Uint8ClampedArray(n*f*3);let v=0;const x=h+1-f;let w=f;for(let t=h;t>=x;t--){console.log(`worker[${y}] scanlines remaining ${w--}`);for(let o=0;o<n;o++){let i=new c.default(0,0,0);for(let u=0;u<m;u++){const u=(o+s.randomNumber())/(n-1),l=(t+s.randomNumber())/(d-1),f=e.getRay(u,l);i=c.default.addVec3(i,a.rayColor(f,r,_))}g(p,v,i,m),v+=3}}const j={cmd:u.ComputeCommands.END,data:{workerId:y,pixelArray:p,startLine:h,scanlineCount:f}};b.postMessage(j)})(e)}})},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(0)),a=o(r(3)),s=r(2),c=r(1);let u=class{constructor(){}init(t,e,r,n,o,a,c){const u=s.degreeToRadians(n),l=2*Math.tan(u/2),d=o*l;this.w=i.default.unit_vector(i.default.subVec3(t,e)),this.u=i.default.unit_vector(i.default.cross(r,this.w)),this.v=i.default.cross(this.w,this.u),this.lookFrom=t,this.horizontal=i.default.multScalarVec3(this.u,c*d),this.vertical=i.default.multScalarVec3(this.v,c*l);const f=i.default.divScalarVec(this.horizontal,2),h=i.default.divScalarVec(this.vertical,2),m=i.default.multScalarVec3(this.w,c);this.lowerLeftCorner=i.default.subVec3(i.default.subVec3(i.default.subVec3(this.lookFrom,f),h),m),this.lenseRadius=a/2}getRay(t,e){const r=i.default.multScalarVec3(i.default.randomInUnitdisk(),this.lenseRadius),n=i.default.multScalarVec3(this.u,r.x),o=i.default.multScalarVec3(this.v,r.y),s=i.default.addVec3(n,o),c=i.default.multScalarVec3(this.horizontal,t),u=i.default.multScalarVec3(this.vertical,e);return new a.default(i.default.addVec3(this.lookFrom,s),i.default.subVec3(i.default.subVec3(i.default.addVec3(i.default.addVec3(this.lowerLeftCorner,c),u),this.lookFrom),s))}getUniformArray(){const t=[];return t.push(...this.lookFrom.array,0),t.push(...this.lowerLeftCorner.array,0),t.push(...this.horizontal.array,0),t.push(...this.vertical.array,0),t.push(...this.u.array,0),t.push(...this.v.array,0),t.push(...this.w.array,0),t.push(this.lenseRadius),new Float32Array(t)}};u=n([c.serializable],u),e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;const n=r(6);e.serialize=function(t,e){return function t(e,r){const o={},i=Object.getOwnPropertyNames(r);for(const e of i){const n=r[e];Array.isArray(n)?o[e]=n.map(e=>t(e.constructor,e)):o[e]="object"==typeof n?t(n.constructor,n):n}return o[n.CLASSNAME_KEY]=r.constructor.name,o}(0,e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.serializable=void 0;const n=r(9);e.serializable=function(t){n.addClassName(t)}},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.HittableList=void 0;const i=r(4),a=o(r(5)),s=r(1);let c=class extends i.Hittable{constructor(t){super(),this._objects=[],t&&this.add(t)}get objects(){return this._objects}clear(){this._objects.length=0}add(t){this._objects.push(t)}hit(t,e,r,n){const o=new i.HitRecord;let a=!1,s=r;for(const r of this._objects)r.hit(t,e,s,o)&&(a=!0,s=o.t,o.copyTo(n));return a}boundingBox(t){if(0===this._objects.length)return!1;const e=new a.default;let r=!0;for(const n of this._objects){if(!n.boundingBox(e))return!1;r?e.copyTo(t):a.default.surroundingBox(t,e).copyTo(t),r=!1}return!0}};c=n([s.serializable],c),e.HittableList=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ComputeCommands=e.ControllerCommands=void 0,function(t){t[t.START=0]="START",t[t.STOP=1]="STOP",t[t.END=2]="END"}(e.ControllerCommands||(e.ControllerCommands={})),function(t){t[t.START=0]="START",t[t.END=1]="END"}(e.ComputeCommands||(e.ComputeCommands={}))},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(4),a=o(r(0)),s=o(r(5)),c=r(1);let u=class extends i.Hittable{constructor(t,e,r){super(),this.center=t,this.radius=e,this.mat=r}hit(t,e,r,n){const o=a.default.subVec3(t.origin,this.center),i=t.direction.lengthSquared(),s=a.default.dot(o,t.direction),c=s*s-i*(o.lengthSquared()-this.radius*this.radius);if(c>0){const o=Math.sqrt(c);let u=(-s-o)/i;if(u<r&&u>e){n.t=u,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius);return n.set_face_normal(t,e),n.mat=this.mat,!0}if(u=(-s+o)/i,u<r&&u>e){n.t=u,n.p=t.at(n.t);const e=a.default.divScalarVec(a.default.subVec3(n.p,this.center),this.radius);return n.set_face_normal(t,e),n.mat=this.mat,!0}}return!1}boundingBox(t){return new s.default(a.default.subVec3(this.center,new a.default(this.radius,this.radius,this.radius)),a.default.addVec3(this.center,new a.default(this.radius,this.radius,this.radius))).copyTo(t),!0}};u=n([c.serializable],u),e.default=u},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(7)),a=o(r(3)),s=o(r(0)),c=r(1);let u=class extends i.default{constructor(t){super(),this.albedo=t}scatter(t,e,r,n){const o=s.default.addVec3(e.normal,s.default.randomUnitVector());return new a.default(e.p,o).copyTo(n),this.albedo.copyTo(r),!0}};u=n([c.serializable],u),e.default=u},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(7)),a=o(r(3)),s=o(r(0)),c=r(1);let u=class extends i.default{constructor(t,e){super(),this.albedo=t,this.roughness=e}scatter(t,e,r,n){const o=s.default.reflect(s.default.unit_vector(t.direction),e.normal);return new a.default(e.p,s.default.addVec3(o,s.default.multScalarVec3(s.default.randomInUnitSphere(),this.roughness))).copyTo(n),this.albedo.copyTo(r),s.default.dot(n.direction,e.normal)>0}};u=n([c.serializable],u),e.default=u},function(t,e,r){"use strict";var n=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(r(7)),a=o(r(3)),s=r(2),c=o(r(0)),u=r(1);let l=class extends i.default{constructor(t){super(),this._refIdx=t}schlick(t,e){let r=(1-e)/(1+e);return r*=r,r+(1-r)*Math.pow(1-t,5)}scatter(t,e,r,n){r.set(1,1,1);const o=e.front_face?1/this._refIdx:this._refIdx,i=c.default.unit_vector(t.direction),u=Math.min(c.default.dot(i.negate(),e.normal),1);if(o*Math.sqrt(1-u*u)>1){const t=c.default.reflect(i,e.normal);return new a.default(e.p,t).copyTo(n),!0}const l=this.schlick(u,o);if(s.randomNumber()<l){const t=c.default.reflect(i,e.normal);return new a.default(e.p,t).copyTo(n),!0}const d=c.default.refract(i,e.normal,o);return new a.default(e.p,d).copyTo(n),!0}};l=n([u.serializable],l),e.default=l},function(t,e,r){"use strict";var n,o=this&&this.__decorate||function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=r(4),s=i(r(5)),c=r(2),u=r(1);let l=n=class extends a.Hittable{constructor(){super(),this.box=new s.default}static createFromHitableList(t){const e=new n;return e.init(t.objects,0,t.objects.length),e}static createFromObjects(t,e,r){const o=new n;return o.init(t,e,r),o}init(t,e,r){const o=c.randomInt(0,2),i=0===o?f:1===o?h:m,a=r-e;if(1===a)this.left=this.right=t[e];else if(2===a)-1===i(t[e],t[e+1])?(this.left=t[e],this.right=t[e+1]):(this.left=t[e+1],this.right=t[e]);else{c.sortArrayRange(t,e,r,i);const o=e+Math.floor(a/2);this.left=n.createFromObjects(t,e,o),this.right=n.createFromObjects(t,o,r)}const u=new s.default,l=new s.default;this.left.boundingBox(u)&&this.right.boundingBox(l)||console.error("No bounding box in bvh_node constructor."),this.box=s.default.surroundingBox(u,l)}hit(t,e,r,n){return!!this.box.hit(t,e,r)&&(this.left.hit(t,e,r,n)?(this.right.hit(t,e,n.t,n),!0):this.right.hit(t,e,r,n))}boundingBox(t){return this.box.copyTo(t),!0}};function d(t,e,r){const n=new s.default,o=new s.default;return t.boundingBox(n)&&e.boundingBox(o)||console.error("No bounding box in bvh_node constructor."),n.min.array[r]<o.min.array[r]?-1:1}function f(t,e){return d(t,e,0)}function h(t,e){return d(t,e,1)}function m(t,e){return d(t,e,2)}l=n=o([u.serializable],l),e.default=l}]);